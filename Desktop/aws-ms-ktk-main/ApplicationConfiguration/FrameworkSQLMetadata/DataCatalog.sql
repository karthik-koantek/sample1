/************************************************************************************/
-- Data Catalog
/************************************************************************************/
EXEC [dbo].[HydrateDataCatalog] @ProjectName = 'Data Catalog', @SystemName = 'Data Lake Catalog', @SystemSecretScope = 'internal', @SystemOrder = 10, @SystemIsActive = 1, @StageName = 'Data Catalog Master', @StageIsActive = 1, @StageOrder = 10, @JobName = 'datacatalog_master', @JobOrder = 10, @JobIsActive = 1, @ExcludeDatabases = 'bronze,archive,default,sandbox', @ExcludeTables = '', @ThreadPool = '4', @TimeoutSeconds = 180000, @VacuumRetentionHours = 672, @NotebookPath = '../Exploratory Data Analysis/Data Catalog Master';
GO
EXEC [dbo].[HydrateGoldZone] @ProjectName = 'Data Catalog', @SystemName = 'Data Lake Catalog', @SystemSecretScope = 'internal', @SystemIsActive = 1, @SystemOrder = 10, @StageName = 'Data Catalog Load Gold Zone', @StageIsActive = 1, @StageOrder = 20 , @JobName = 'datacatalog_loadgoldzone_datacatalogdatabase', @JobIsActive = 1, @JobOrder = 10, @ViewName = 'goldprotected.vDataCatalogDatabase', @TableName = 'goldprotected.DataCatalogDatabase', @Purpose = 'datacatalog', @PrimaryKeyColumns = 'databaseId', @PartitionColumn = '', @ClusterColumn = 'pk', @ClusterBuckets = '8', @OptimizeWhere = '', @OptimizeZOrderBy = '', @VacuumRetentionHours = '168', @LoadType = 'MergeType2', @DeleteNotInSource = 'true', @Destination = 'goldprotected', @GoldZoneNotebookPath = '../Data Engineering/Gold Zone/Gold Load';
EXEC [dbo].[HydrateGoldZone] @ProjectName = 'Data Catalog', @SystemName = 'Data Lake Catalog', @SystemSecretScope = 'internal', @SystemIsActive = 1, @SystemOrder = 10, @StageName = 'Data Catalog Load Gold Zone', @StageIsActive = 1, @StageOrder = 20 , @JobName = 'datacatalog_loadgoldzone_datacatalogtable', @JobIsActive = 1, @JobOrder = 10, @ViewName = 'goldprotected.vDataCatalogTable', @TableName = 'goldprotected.DataCatalogTable', @Purpose = 'datacatalog', @PrimaryKeyColumns = 'tableId', @PartitionColumn = 'databaseName', @ClusterColumn = 'pk', @ClusterBuckets = '8', @OptimizeWhere = '', @OptimizeZOrderBy = '', @VacuumRetentionHours = '168', @LoadType = 'MergeType2', @DeleteNotInSource = 'true', @Destination = 'goldprotected', @GoldZoneNotebookPath = '../Data Engineering/Gold Zone/Gold Load';
EXEC [dbo].[HydrateGoldZone] @ProjectName = 'Data Catalog', @SystemName = 'Data Lake Catalog', @SystemSecretScope = 'internal', @SystemIsActive = 1, @SystemOrder = 10, @StageName = 'Data Catalog Load Gold Zone', @StageIsActive = 1, @StageOrder = 20 , @JobName = 'datacatalog_loadgoldzone_datacatalogcolumn', @JobIsActive = 1, @JobOrder = 10, @ViewName = 'goldprotected.vDataCatalogColumn', @TableName = 'goldprotected.DataCatalogColumn', @Purpose = 'datacatalog', @PrimaryKeyColumns = 'columnId,tableId', @PartitionColumn = 'databaseName,tableName', @ClusterColumn = 'pk', @ClusterBuckets = '8', @OptimizeWhere = '', @OptimizeZOrderBy = '', @VacuumRetentionHours = '168', @LoadType = 'MergeType2', @DeleteNotInSource = 'true', @Destination = 'goldprotected', @GoldZoneNotebookPath = '../Data Engineering/Gold Zone/Gold Load';
EXEC [dbo].[HydrateGoldZone] @ProjectName = 'Data Catalog', @SystemName = 'Data Lake Catalog', @SystemSecretScope = 'internal', @SystemIsActive = 1, @SystemOrder = 10, @StageName = 'Data Catalog Load Gold Zone', @StageIsActive = 1, @StageOrder = 20 , @JobName = 'datacatalog_loadgoldzone_datacatalogcolumnvaluecounts', @JobIsActive = 1, @JobOrder = 10, @ViewName = 'goldprotected.vDataCatalogColumnValueCounts', @TableName = 'goldprotected.DataCatalogColumnValueCounts', @Purpose = 'datacatalog', @PrimaryKeyColumns = 'columnId,value', @PartitionColumn = 'databaseName,tableName', @ClusterColumn = 'pk', @ClusterBuckets = '8', @OptimizeWhere = '', @OptimizeZOrderBy = '', @VacuumRetentionHours = '168', @LoadType = 'Overwrite', @DeleteNotInSource = 'false', @Destination = 'goldprotected', @GoldZoneNotebookPath = '../Data Engineering/Gold Zone/Gold Load';
EXEC [dbo].[HydrateGoldZone] @ProjectName = 'Data Catalog', @SystemName = 'Data Lake Catalog', @SystemSecretScope = 'internal', @SystemIsActive = 1, @SystemOrder = 10, @StageName = 'Data Catalog Load Gold Zone', @StageIsActive = 1, @StageOrder = 20 , @JobName = 'datacatalog_loadgoldzone_datacatalogfile', @JobIsActive = 1, @JobOrder = 10, @ViewName = 'goldprotected.vDataCatalogFile', @TableName = 'goldprotected.DataCatalogFile', @Purpose = 'datacatalog', @PrimaryKeyColumns = 'storageAccountName,fileSystemName,fileName', @PartitionColumn = 'storageAccountName,fileSystemName', @ClusterColumn = 'pk', @ClusterBuckets = '8', @OptimizeWhere = '', @OptimizeZOrderBy = '', @VacuumRetentionHours = '168', @LoadType = 'MergeType2', @DeleteNotInSource = 'false', @Destination = 'goldprotected', @GoldZoneNotebookPath = '../Data Engineering/Gold Zone/Gold Load';
UPDATE dbo.Stage SET NumberOfThreads = 5 WHERE StageName = 'Data Catalog Load Gold Zone';
GO
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_database',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.DataCatalogDatabase',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogDatabase', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_table',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.DataCatalogTable',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogTable', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_column',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.DataCatalogColumn',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogColumn', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_columnvaluecounts',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.DataCatalogColumnValueCounts',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogColumnValueCounts', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_file',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.DataCatalogFile',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogFile', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_growthtable',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.vDataCatalogTableGrowth',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogTableGrowth', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
EXEC [dbo].[HydratePlatinumZone] @ProjectName = 'Data Catalog',@SystemName = 'Data Lake Catalog',@SystemSecretScope = 'metadatadb',@SystemIsActive = 1,@SystemOrder = 10,@StageName = 'Data Catalog Load to Metadata DB',@StageIsActive = 1,@StageOrder = 30,@JobName = 'datacatalog_loadmetadatadb_growthfile',@JobIsActive = 1,@JobOrder = 10,@TableName = 'goldprotected.vDataCatalogFileGrowth',@DestinationSchemaName = 'dbo',@DestinationTableName='DataCatalogFileGrowth', @StoredProcedureName = '',@NumPartitions='8', @IgnoreDateToProcessFilter='true', @LoadType='overwrite', @TruncateTableInsteadOfDropAndReplace='true', @IsolationLevel='READ_COMMITTED', @PresentationZoneNotebookPath = '../Data Engineering/Presentation Zone/SQL Spark Connector 3';
UPDATE dbo.Stage SET NumberOfThreads = 1 WHERE StageName = 'Data Catalog Load to Metadata DB';